services:
  - type: web
    name: swati-jewelers-backend
    env: python
    plan: free
    region: ohio
    branch: main
    
    # Force Python version
    pythonVersion: "3.11.8"
    
    # Explicit build commands to override Poetry
    buildCommand: |-
      python --version
      pip install --upgrade pip
      pip install wheel
      pip install --no-cache-dir -r requirements.txt
      
    # Start Command
    startCommand: |-
      gunicorn run:app --bind 0.0.0.0:$PORT
      
    # Root directory for the backend
    rootDirectory: backend
    
    # Environment Variables
    envVars:
      - key: FLASK_ENV
        value: production
      - key: SECRET_KEY
        generateValue: true
      - key: JWT_SECRET_KEY  
        generateValue: true
      - key: MONGODB_URI
        value: mongodb+srv://shivamjhamay2002_db_user:PCYNwq8nyVz6sKWO@swati-jwellers-cluster.nnxxfwo.mongodb.net/?appName=swati-jwellers-cluster
      - key: CORS_ORIGINS
        value: https://your-frontend-domain.onrender.com,http://localhost:5173,http://localhost:5174,http://localhost:3000
      - key: MODEL_PATH
        value: models/
      - key: RAZORPAY_KEY_ID
        value: rzp_test_RhfmPzWtmBE0Xs
      - key: RAZORPAY_KEY_SECRET
        value: ZdWqXaiKUbD98sb0MWQ5fERO
      - key: RAZORPAY_WEBHOOK_SECRET
        value: UQhJS_a5UWb4nkL
      - key: GST_RATE
        value: 0.03
      - key: SHIPPING_RATE
        value: 100.0
      - key: CART_SESSION_TIMEOUT
        value: 86400
      - key: GEMINI_SYMBOLS
        value: BTCUSD,ETHUSD
      - key: PRICE_FETCH_INTERVAL
        value: 60
      - key: USD_TO_INR_RATE
        value: 83.0
      - key: GEMINI_AI_API_KEY
        value: AIzaSyCFLnOXgY4GvcHKMGx9eklNZ9kz3_ckJq0
      - key: GEMINI_AI_MODEL
        value: gemini-2.5-flash

    healthCheckPath: /api/health